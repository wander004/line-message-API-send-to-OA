function doPost(e) {
  var data = JSON.parse(e.postData.contents)
  //var userMsg = data.originalDetectIntentRequest.payload.data.message.text;
  //var values = sheet.getRange(2, 2, sheet.getLastRow(),sheet.getLastColumn()).getValues(); //ค้นหาจาก column2 เริ่มจาก row2

  var result = {
    "fulfillmentMessages": [
      {
        "platform": "line",
        "type": 4,
        "payload" : {
          "line":  {


            "type": "flex",
            "altText": "this is a flex message",
            "contents": {
              

  "type": "bubble",
  "hero": {
    "type": "image",
    "url": "https://scdn.line-apps.com/n/channel_devcenter/img/fx/01_1_cafe.png",
    "size": "full",
    "aspectRatio": "20:13",
    "aspectMode": "cover",
    "action": {
      "type": "uri",
      "uri": "http://linecorp.com/"
    }
  },
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "text",
        "text": "Brown Cafe",
        "weight": "bold",
        "size": "xl"
      }
    ]
  }


            }


          }
        }
      }
    ]
  }
      
  var replyJSON = ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JSON);
  return replyJSON;
}

//send normal text example
/*
function doPost(e) {
  var data = JSON.parse(e.postData.contents)
  //var userMsg = data.originalDetectIntentRequest.payload.data.message.text;
  //var values = sheet.getRange(2, 2, sheet.getLastRow(),sheet.getLastColumn()).getValues(); //ค้นหาจาก column2 เริ่มจาก row2

  var result = {
    "fulfillmentMessages": [
      {
        "platform": "line",
        "type": 4,
        "payload" : {
          "line":  {
            "type": "text",
            "text": "เลือกเพื่อค้นหาต่อ"
            ,"quickReply": { // ②
              "items": [
                {
                  "type": "action", // ③
                  "imageUrl": "https://cdn.iconscout.com/icon/premium/png-256-thumb/data-339-207876.png",
                  "action": {
                    "type": "message",
                    "label": "#test",
                    "text": "#test"
                  }
                }
              ]
            }
          }  
        }
      }
    ]
  }
      
  var replyJSON = ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JSON);
  return replyJSON;
}
*/
